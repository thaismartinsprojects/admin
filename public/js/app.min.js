"use strict";angular.module("adminThaisMartins",["ui.router","ui.utils.masks","angularMoment"]).config(["$locationProvider","$stateProvider","$urlRouterProvider",function(a,e,r){r.otherwise("/dashboard"),e.state("root",{"abstract":!0,views:{header:{templateUrl:"app/views/partials/header.html"},menu:{templateUrl:"app/views/partials/menu.html"}}}).state("login",{url:"/login",requiredLogin:!1,views:{"main@":{templateUrl:"app/views/login/index.html",controller:"LoginController"},"error@login":{templateUrl:"app/views/partials/error.html"}}}).state("dashboard",{url:"/dashboard",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/dashboard/index.html",controller:"DashboardController"}}}).state("menus",{url:"/menus",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/menus/index.html",controller:"MenusController"}}}).state("menus.add",{url:"/menus/new",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/menus/form.html",controller:"MenusController"}}}).state("menus.edit",{url:"/menus/edit/:id",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/menus/form.html",controller:"MenusController"}}}).state("skills",{parent:"root"}).state("skills.categories",{url:"/skills",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/skills/categories/index.html",controller:"SkillsController"}}}).state("skills.categories.add",{url:"/skills/new",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/skills/categories/form.html",controller:"SkillsController"}}}).state("skills.items",{url:"/skills/items",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/skills/items/index.html",controller:"SkillsController"}}}).state("skills.items.add",{url:"/skills/items/new",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/skills/items/form.html",controller:"SkillsController"}}}).state("works",{url:"/works",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/works/index.html",controller:"WorksController"}}}).state("works.add",{url:"/works/new",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/works/form.html",controller:"WorksController"}}}).state("contacts",{url:"/contacts",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/contacts/index.html",controller:"ContactsController"}}}).state("contacts.edit",{url:"/contacts/edit/:id",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/contacts/form.html",controller:"ContactsController"}}}).state("messages",{url:"/messages",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/messages/index.html",controller:"MessagesController"},"conversation@messages":{templateUrl:"app/views/messages/conversation.html",controller:"MessagesConversationController"},"users@messages":{templateUrl:"app/views/messages/users.html"}}}).state("user",{url:"/user",parent:"root",requiredLogin:!0,views:{"error@user":{templateUrl:"app/views/partials/error.html"},"main@":{templateUrl:"app/views/user/index.html",controller:"UserController"}}}).state("info",{url:"/info",parent:"root",requiredLogin:!0,views:{"main@":{templateUrl:"app/views/info/index.html",controller:"InfoController"}}})}]),angular.module("adminThaisMartins").factory("ActMessagesService",function(){return{error:{onSave:"Erro ao salvar informações. Por favor, tente novamente."},success:{onSave:"Informações salvas com sucesso!"}}}),angular.module("adminThaisMartins").factory("ChatService",["URI","UserService",function(a,e){var r=io.connect(a.CHAT);return e.isLogged()&&r.on("connect",function(){console.log("Chat connected with success"),r.emit("openchat",{code:e.getCode()})}),r}]),angular.module("adminThaisMartins").factory("IconService",function(){var a=["fa-glass","fa-music","fa-search","fa-envelope-o","fa-heart","fa-star","fa-star-o","fa-user","fa-film","fa-th-large","fa-th","fa-th-list","fa-check","fa-remove","fa-close","fa-times","fa-search-plus","fa-search-minus","fa-power-off","fa-signal","fa-gear","fa-cog","fa-trash-o","fa-home","fa-file-o","fa-clock-o","fa-road","fa-download","fa-arrow-circle-o-down","fa-arrow-circle-o-up","fa-inbox","fa-play-circle-o","fa-rotate-right","fa-repeat","fa-refresh","fa-list-alt","fa-lock","fa-flag","fa-headphones","fa-volume-off","fa-volume-down","fa-volume-up","fa-qrcode","fa-barcode","fa-tag","fa-tags","fa-book","fa-bookmark","fa-print","fa-camera","fa-font","fa-bold","fa-italic","fa-text-height","fa-text-width","fa-align-left","fa-align-center","fa-align-right","fa-align-justify","fa-list","fa-dedent","fa-outdent","fa-indent","fa-video-camera","fa-photo","fa-image","fa-picture-o","fa-pencil","fa-map-marker","fa-adjust","fa-tint","fa-edit","fa-pencil-square-o","fa-share-square-o","fa-check-square-o","fa-arrows","fa-step-backward","fa-fast-backward","fa-backward","fa-play","fa-pause","fa-stop","fa-forward","fa-fast-forward","fa-step-forward","fa-eject","fa-chevron-left","fa-chevron-right","fa-plus-circle","fa-minus-circle","fa-times-circle","fa-check-circle","fa-question-circle","fa-info-circle","fa-crosshairs","fa-times-circle-o","fa-check-circle-o","fa-ban","fa-arrow-left","fa-arrow-right","fa-arrow-up","fa-arrow-down","fa-mail-forward","fa-share","fa-expand","fa-compress","fa-plus","fa-minus","fa-asterisk","fa-exclamation-circle","fa-gift","fa-leaf","fa-fire","fa-eye","fa-eye-slash","fa-warning","fa-exclamation-triangle","fa-plane","fa-calendar","fa-random","fa-comment","fa-magnet","fa-chevron-up","fa-chevron-down","fa-retweet","fa-shopping-cart","fa-folder","fa-folder-open","fa-arrows-v","fa-arrows-h","fa-bar-chart-o","fa-bar-chart","fa-twitter-square","fa-facebook-square","fa-camera-retro","fa-key","fa-gears","fa-cogs","fa-comments","fa-thumbs-o-up","fa-thumbs-o-down","fa-star-half","fa-heart-o","fa-sign-out","fa-linkedin-square","fa-thumb-tack","fa-external-link","fa-sign-in","fa-trophy","fa-github-square","fa-upload","fa-lemon-o","fa-phone","fa-square-o","fa-bookmark-o","fa-phone-square","fa-twitter","fa-facebook-f","fa-facebook","fa-github","fa-unlock","fa-credit-card","fa-rss","fa-hdd-o","fa-bullhorn","fa-bell","fa-certificate","fa-hand-o-right","fa-hand-o-left","fa-hand-o-up","fa-hand-o-down","fa-arrow-circle-left","fa-arrow-circle-right","fa-arrow-circle-up","fa-arrow-circle-down","fa-globe","fa-wrench","fa-tasks","fa-filter","fa-briefcase","fa-arrows-alt","fa-group","fa-users","fa-chain","fa-link","fa-cloud","fa-flask","fa-cut","fa-scissors","fa-copy","fa-files-o","fa-paperclip","fa-save","fa-floppy-o","fa-square","fa-navicon","fa-reorder","fa-bars","fa-list-ul","fa-list-ol","fa-strikethrough","fa-underline","fa-table","fa-magic","fa-truck","fa-pinterest","fa-pinterest-square","fa-google-plus-square","fa-google-plus","fa-money","fa-caret-down","fa-caret-up","fa-caret-left","fa-caret-right","fa-columns","fa-unsorted","fa-sort","fa-sort-down","fa-sort-desc","fa-sort-up","fa-sort-asc","fa-envelope","fa-linkedin","fa-rotate-left","fa-undo","fa-legal","fa-gavel","fa-dashboard","fa-tachometer","fa-comment-o","fa-comments-o","fa-flash","fa-bolt","fa-sitemap","fa-umbrella","fa-paste","fa-clipboard","fa-lightbulb-o","fa-exchange","fa-cloud-download","fa-cloud-upload","fa-user-md","fa-stethoscope","fa-suitcase","fa-bell-o","fa-coffee","fa-cutlery","fa-file-text-o","fa-building-o","fa-hospital-o","fa-ambulance","fa-medkit","fa-fighter-jet","fa-beer","fa-h-square","fa-plus-square","fa-angle-double-left","fa-angle-double-right","fa-angle-double-up","fa-angle-double-down","fa-angle-left","fa-angle-right","fa-angle-up","fa-angle-down","fa-desktop","fa-laptop","fa-tablet","fa-mobile-phone","fa-mobile","fa-circle-o","fa-quote-left","fa-quote-right","fa-spinner","fa-circle","fa-mail-reply","fa-reply","fa-github-alt","fa-folder-o","fa-folder-open-o","fa-smile-o","fa-frown-o","fa-meh-o","fa-gamepad","fa-keyboard-o","fa-flag-o","fa-flag-checkered","fa-terminal","fa-code","fa-mail-reply-all","fa-reply-all","fa-star-half-empty","fa-star-half-full","fa-star-half-o","fa-location-arrow","fa-crop","fa-code-fork","fa-unlink","fa-chain-broken","fa-question","fa-info","fa-exclamation","fa-superscript","fa-subscript","fa-eraser","fa-puzzle-piece","fa-microphone","fa-microphone-slash","fa-shield","fa-calendar-o","fa-fire-extinguisher","fa-rocket","fa-maxcdn","fa-chevron-circle-left","fa-chevron-circle-right","fa-chevron-circle-up","fa-chevron-circle-down","fa-html5","fa-css3","fa-anchor","fa-unlock-alt","fa-bullseye","fa-ellipsis-h","fa-ellipsis-v","fa-rss-square","fa-play-circle","fa-ticket","fa-minus-square","fa-minus-square-o","fa-level-up","fa-level-down","fa-check-square","fa-pencil-square","fa-external-link-square","fa-share-square","fa-compass","fa-toggle-down","fa-caret-square-o-down","fa-toggle-up","fa-caret-square-o-up","fa-toggle-right","fa-caret-square-o-right","fa-euro","fa-eur","fa-gbp","fa-dollar","fa-usd","fa-rupee","fa-inr","fa-cny","fa-rmb","fa-yen","fa-jpy","fa-ruble","fa-rouble","fa-rub","fa-won","fa-krw","fa-bitcoin","fa-btc","fa-file","fa-file-text","fa-sort-alpha-asc","fa-sort-alpha-desc","fa-sort-amount-asc","fa-sort-amount-desc","fa-sort-numeric-asc","fa-sort-numeric-desc","fa-thumbs-up","fa-thumbs-down","fa-youtube-square","fa-youtube","fa-xing","fa-xing-square","fa-youtube-play","fa-dropbox","fa-stack-overflow","fa-instagram","fa-flickr","fa-adn","fa-bitbucket","fa-bitbucket-square","fa-tumblr","fa-tumblr-square","fa-long-arrow-down","fa-long-arrow-up","fa-long-arrow-left","fa-long-arrow-right","fa-apple","fa-windows","fa-android","fa-linux","fa-dribbble","fa-skype","fa-foursquare","fa-trello","fa-female","fa-male","fa-gittip","fa-gratipay","fa-sun-o","fa-moon-o","fa-archive","fa-bug","fa-vk","fa-weibo","fa-renren","fa-pagelines","fa-stack-exchange","fa-arrow-circle-o-right","fa-arrow-circle-o-left","fa-toggle-left","fa-caret-square-o-left","fa-dot-circle-o","fa-wheelchair","fa-vimeo-square","fa-turkish-lira","fa-try","fa-plus-square-o","fa-space-shuttle","fa-slack","fa-envelope-square","fa-wordpress","fa-openid","fa-institution","fa-bank","fa-university","fa-mortar-board","fa-graduation-cap","fa-yahoo","fa-google","fa-reddit","fa-reddit-square","fa-stumbleupon-circle","fa-stumbleupon","fa-delicious","fa-digg","fa-pied-piper","fa-pied-piper-alt","fa-drupal","fa-joomla","fa-language","fa-fax","fa-building","fa-child","fa-paw","fa-spoon","fa-cube","fa-cubes","fa-behance","fa-behance-square","fa-steam","fa-steam-square","fa-recycle","fa-automobile","fa-car","fa-cab","fa-taxi","fa-tree","fa-spotify","fa-deviantart","fa-soundcloud","fa-database","fa-file-pdf-o","fa-file-word-o","fa-file-excel-o","fa-file-powerpoint-o","fa-file-photo-o","fa-file-picture-o","fa-file-image-o","fa-file-zip-o","fa-file-archive-o","fa-file-sound-o","fa-file-audio-o","fa-file-movie-o","fa-file-video-o","fa-file-code-o","fa-vine","fa-codepen","fa-jsfiddle","fa-life-bouy","fa-life-buoy","fa-life-saver","fa-support","fa-life-ring","fa-circle-o-notch","fa-ra","fa-rebel","fa-ge","fa-empire","fa-git-square","fa-git","fa-hacker-news","fa-tencent-weibo","fa-qq","fa-wechat","fa-weixin","fa-send","fa-paper-plane","fa-send-o","fa-paper-plane-o","fa-history","fa-genderless","fa-circle-thin","fa-header","fa-paragraph","fa-sliders","fa-share-alt","fa-share-alt-square","fa-bomb","fa-soccer-ball-o","fa-futbol-o","fa-tty","fa-binoculars","fa-plug","fa-slideshare","fa-twitch","fa-yelp","fa-newspaper-o","fa-wifi","fa-calculator","fa-paypal","fa-google-wallet","fa-cc-visa","fa-cc-mastercard","fa-cc-discover","fa-cc-amex","fa-cc-paypal","fa-cc-stripe","fa-bell-slash","fa-bell-slash-o","fa-trash","fa-copyright","fa-at","fa-eyedropper","fa-paint-brush","fa-birthday-cake","fa-area-chart","fa-pie-chart","fa-line-chart","fa-lastfm","fa-lastfm-square","fa-toggle-off","fa-toggle-on","fa-bicycle","fa-bus","fa-ioxhost","fa-angellist","fa-cc","fa-shekel","fa-sheqel","fa-ils","fa-meanpath","fa-buysellads","fa-connectdevelop","fa-dashcube","fa-forumbee","fa-leanpub","fa-sellsy","fa-shirtsinbulk","fa-simplybuilt","fa-skyatlas","fa-cart-plus","fa-cart-arrow-down","fa-diamond","fa-ship","fa-user-secret","fa-motorcycle","fa-street-view","fa-heartbeat","fa-venus","fa-mars","fa-mercury","fa-transgender","fa-transgender-alt","fa-venus-double","fa-mars-double","fa-venus-mars","fa-mars-stroke","fa-mars-stroke-v","fa-mars-stroke-h","fa-neuter","fa-facebook-official","fa-pinterest-p","fa-whatsapp","fa-server","fa-user-plus","fa-user-times","fa-hotel","fa-bed","fa-viacoin","fa-train","fa-subway","fa-medium"];return{getAll:function(){return a}}}),angular.module("adminThaisMartins").factory("MenuService",function(){var a=[{id:1,name:"Dashboard",icon:"home",slug:"dashboard",childs:null},{id:2,name:"Menu",icon:"index",slug:"menus",childs:null},{id:3,name:"Skills",icon:"lightbulb",slug:"skills",childs:[{id:1,name:"Categorias",icon:"rows",slug:"skills.categories"},{id:2,name:"Items",icon:"quote",slug:"skills.items"}]},{id:4,name:"Trabalhos",icon:"briefcase",slug:"works",childs:null},{id:5,name:"Contatos",icon:"mail",slug:"contacts",childs:null},{id:6,name:"Informações do Site",icon:"desktop",slug:"info",childs:null}];return{getItems:function(){return a}}}),angular.module("adminThaisMartins").factory("MessageService",["URI","$http","UserService",function(a,e,r){var t=a.API+"/messages";return e.defaults.headers.common["x-access-token"]=r.getToken(),{getAll:function(){return e.get(t)},create:function(a){return e.post(t,a)}}}]),angular.module("adminThaisMartins").factory("UserService",["URI","$http",function(a,e){var r=a.API+"/accounts";return{isLogged:function(){return!!localStorage.getItem("token")},doLogout:function(){localStorage.removeItem("token")},doLogin:function(a){return e.post(r+"/auth",a)},getToken:function(){return localStorage.getItem("token")},getCode:function(){return localStorage.getItem("code")},getAll:function(){return e.defaults.headers.common["x-access-token"]=this.getToken(),e.get(r)},get:function(){return e.defaults.headers.common["x-access-token"]=this.getToken(),e.get(r+"/"+this.getCode())},update:function(a){return e.defaults.headers.common["x-access-token"]=this.getToken(),e.put(r+"/"+this.getCode(),a)},upload:function(a){return e.defaults.headers.common["x-access-token"]=this.getToken(),e.put(r+"/"+this.getCode(),a,{withCredentials:!1,headers:{"Content-Type":void 0},transformRequest:angular.identity})}}}]),angular.module("adminThaisMartins").factory("ValidateService",function(){var a={email:{regex:/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/,message:"Utilize um email válido.",checkMessage:""},password:{regex:/^([_a-zA-Z0-9-!?@%]{6,})$/,message:"Sua senha precisa ter no mínimo 6 caracteres.",checkMessage:"Verifique a senha digitada."},cpf:{regex:/^[0-9]{3}\.?[0-9]{3}\.?[0-9]{3}\-?[0-9]{2}$/,message:"Utilize um CPF válido.",checkMessage:""},cnpj:{regex:/^[0-9]{2}\.?[0-9]{3}\.?[0-9]{3}\/?[0-9]{4}\-?[0-9]{2}$/,message:"Utilize um CNPJ válido.",checkMessage:""},"cpf-cnpj":{regex:/^[0-9]{2}\.?[0-9]{3}\.?[0-9]{3}\/?[0-9]{4}\-?[0-9]{2}|[0-9]{3}\.?[0-9]{3}\.?[0-9]{3}\-?[0-9]{2}$/,message:"Utilize um CPF ou CNPJ válido.",checkMessage:""}};return{isEmpty:function(a){var e=function(a){for(var e in a)if(a.hasOwnProperty(e)&&""!=a[e])return!1;return!0};return"undefined"==typeof a||(angular.isArray(a)?a.length<1:angular.isObject(a)?e(a):""==a||null==a)},isValid:function(e,r){var t=!0;return""!=a[e].regex&&(t=a[e].regex.test(r)),!this.isEmpty(r)&&t},getMessage:function(e){return a[e].message},getCheckMessage:function(e){return a[e].checkMessage}}}),angular.module("adminThaisMartins").filter("dateBr",function(){return function(a){if("undefined"==typeof a)return"";var e=a.split("T");return moment(e[0]).format("DD/MM/YYYY")}}),angular.module("adminThaisMartins").filter("dateTimeBr",function(){return function(a){return"undefined"==typeof a?"":(moment.locale("pt-br"),moment(new Date(a)).calendar(null,{sameElse:"DD/MM/YYYY - H:mm"}))}}),angular.module("adminThaisMartins").filter("groupBy",function(){return function(a,e){if("undefined"==typeof a)return!1;var r=[];return angular.forEach(a,function(a,t){"undefined"==typeof r[a[e]]&&(r[a[e]]=[]),r[a[e]].push(a)}),r}}),angular.module("adminThaisMartins").filter("adminThaisMartins",["$filter",function(a){return function(e,r){if("undefined"==typeof e)return!1;var t=[];for(var o in e)e.hasOwnProperty(o)&&(t[o]=a("orderBy")(e[o],r));return t}}]),angular.module("adminThaisMartins").directive("file",function(){return{require:"ngModel",scope:{onSelect:"&",work:"&"},restrict:"AE",link:function(a,e,r,t){var o=r.multiple||!1,n=function(){c.trigger("click")},s=function(a){var e="";if(a.length>1){for(var r in a)a[r]instanceof File&&(e+=a[r].name+", ");e=e.substring(0,30)+"..."}else e=a[0].name;return e},i=function(e){var o=e.target.files;o.length>1?t.$setViewValue(o):t.$setViewValue(o[0]),l.html(s(o)),a.$apply(),a.onSelect({model:r.id})},f=$("<div></div>").addClass("input-file").appendTo(e),l=$("<small></small>").html("Selecione um arquivo...").appendTo(f),c=$("<input />").addClass(r.classes).attr("type","file").attr("id",r.id).attr("accept",r.types).attr("multiple",o).bind("change",i).appendTo(f);$("<span></span>").html("Escolher").bind("click",n).appendTo(f)}}}),angular.module("adminThaisMartins").directive("multipleList",function(){return{restrict:"EA",require:"?ngModel",template:'<div class="multiple-list"><ul></ul></div>',link:function(a,e,r){var t=function(e){var r=e;if(r.indexOf(".")>0){var t=r.split(".");r=a;for(var o in t)r=r[t[o]]}return r},o=t(r.ngModelList),n=function(){var e=$(this).closest("li");o=jQuery.grep(o,function(a){return a!==e.find(".value").html()}),a.$apply(),e.remove()},s=function(e){if(44===e.which||13===e.which){var r=$("<li></li>").html('<span class="value">'+this.value+"</span>");$("<span></span>").addClass("remove").html("x").bind("click",n).appendTo(r),r.appendTo($(".multiple-list ul")),o.push(this.value),a.$apply(),this.value="",e.preventDefault()}};$("#multiple-option").bind("keydown keypress",s)}}}),angular.module("adminThaisMartins").directive("ngEnter",function(){return function(a,e,r){var t=function(e){13===e.which&&(a.$apply(function(){a.$eval(r.ngEnter,{event:e})}),e.preventDefault())};e.bind("keydown keypress",t)}}),angular.module("adminThaisMartins").directive("uiBrDateMask",function(){return{require:"ngModel",restrict:"AE",link:function(a,e,r,t){t.$formatters.push(function(a){return"undefined"==typeof a?"":(o(a)&&(a=moment(new Date(a)).format("DD/MM/YYYY")),a)}),t.$parsers.push(function(a){if("undefined"==typeof a)return"";a=a.toString().replace(/['"R$;:.,*\/?=\\-]/g,"");var e=/^\d+$/;return e.test(a)&&8==a.length&&(a=s(a)),a});var o=function(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)||"Invalid date"!=new Date(a)},n=function(a){return a.replace(/^(\d{2})(\d{2})(\d{4})/,"$2/$1/$3")},s=function(a){return a=n(a),new Date(a)},i=function(){var a=e.val();a.toString().replace(/\D/g,""),a=a.toString().replace(/['"R$;:.,*\/?=\\-]/g,""),a=a.substring(0,8),a=a.replace(/\D/g,""),a=a.replace(/(\d{2})(\d)/,"$1/$2"),a=a.replace(/(\d{2})(\d)/,"$1/$2"),t.$setViewValue(a),t.$render()};e.bind("keydown keypress keyup",i)}}}),angular.module("adminThaisMartins").controller("ContactsController",["$scope",function(a){}]),angular.module("adminThaisMartins").controller("DashboardController",["$scope",function(a){}]),angular.module("adminThaisMartins").controller("InfoController",["$scope",function(a){a.info={}}]),angular.module("adminThaisMartins").controller("LoginController",["$scope","$state","ValidateService","UserService",function(a,e,r,t){a.doLogin=function(){return a.error=!1,!a.login||r.isEmpty(a.login.username)||r.isEmpty(a.login.password)?(a.error="Por favor, preencha todos os dados.",!1):void t.doLogin(a.login).then(function(a){localStorage.setItem("token",a.data.token),localStorage.setItem("code",a.data.code),e.go("dashboard")},function(e){a.error="Por favor, verifique os dados digitados e tente novamente."})}}]),angular.module("adminThaisMartins").controller("MenusController",["$scope",function(a){}]),angular.module("adminThaisMartins").controller("MessagesConversationController",["$scope","MessageService","ChatService",function(a,e,r){var t=function(e,r){return("undefined"==typeof a.current.user||a.current.user._id!=r)&&e==r};a.visibleSearch=!1,a.showSearch=function(){a.search.message="",a.visibleSearch=!a.visibleSearch},a.sendMessage=function(){if(!a.text)return!1;var e={to:a.$parent.current.user._id,from:a.$parent.code,message:a.text,created:new Date};r.emit("message",e),a.$parent.current.messages.push(e),a.text="",a.$parent.scrollChat()},r.on("message",function(e){angular.forEach(a.$parent.users,function(a){t(a._id,e._id)?a.hasMessage.push(e):r.emit("visualized",e)}),a.$parent.messages[e.from].messages.push(e),a.$parent.scrollChat(),a.$apply()})}]),angular.module("adminThaisMartins").controller("MessagesController",["$scope","$rootScope","$filter","UserService","MessageService","ChatService",function(a,e,r,t,o,n){a.visibleSearch=!1,a.search={},a.messages=[],a.current={},a.text="",o.getAll().then(function(t){angular.forEach(e.users,function(o){var n=r("filter")(t.data,{to:e.code,from:o._id}),s=r("filter")(t.data,{to:o._id,from:e.code}),i=s.concat(n);o.hasMessage=r("filter")(i,{to:e.code,visualized:!1}),a.messages[o._id]={messages:r("orderBy")(i,"created"),user:o}})}),a.scrollChat=function(){setTimeout(function(){var a=document.getElementById("talks");a&&$("#talks-box").animate({scrollTop:a.scrollHeight},300)},300)},a.showConversation=function(t){a.current.messages=a.messages[t].messages,a.current.user=a.messages[t].user,a.scrollChat();var o=r("filter")(a.current.messages,{to:e.code,visualized:!1});angular.forEach(o,function(a){a.visualized||n.emit("visualized",a)}),angular.forEach(a.users,function(a){a._id==t&&(a.hasMessage=[])})}}]),angular.module("adminThaisMartins").controller("SkillsController",["$scope","IconService",function(a,e){a.skills=[],a.skill={},a.skill.items=[],a.icons=e.getAll(),a.setIcon=function(e){a.skill.icon=e}}]),angular.module("adminThaisMartins").controller("UserController",["$scope","$rootScope","URI","ActMessagesService","UserService",function(a,e,r,t,o){a.visiblePass=!1,a.showPass=function(){a.visiblePass=!0},a.save=function(){e.error=!1,o.update(a.user).then(function(n){var s=a.user.photo;if(a.user=n.data,a.user.password="",s){var i=new FormData;i.append("photo",s),o.upload(i).then(function(e){a.user.thumbnail=r.API+"/files/users/"+e.data.photo})}e.success=t.success.onSave},function(a){e.error=t.error.onSave})}}]),angular.module("adminThaisMartins").controller("WorksController",["$scope",function(a){a.work={},a.work.tags=[],a.changeImages=function(a){}}]),angular.module("adminThaisMartins").run(["$rootScope","$state","amMoment","URI","MenuService","UserService","ChatService",function(a,e,r,t,o,n,s){r.changeLocale("pt-br"),a.activeMenu=!0,a.error=!1,a.menu=o.getItems(),a.code=n.getCode(),a.users=!1,a.toogleMenu=function(){a.activeMenu=!a.activeMenu},a.doLogout=function(){n.doLogout(),e.go("login")},a.goToUser=function(){e.go("user")},a.showMessages=!1,a.toggleMessages=function(){a.showMessages=!a.showMessages},a.$on("$stateChangeSuccess",function(){a.showMessages=!1,e.current.requiredLogin&&!n.isLogged()&&e.go("login"),"login"==e.current.name||a.users||(n.getAll().then(function(e){a.users=e.data.filter(function(e){return e._id!=a.code})}),n.get().then(function(e){a.user=e.data,a.user.photo?a.user.thumbnail=t.API+"/files/users/"+a.user.photo:a.user.thumbnail="public/images/user.png"},function(e){a.doLogout()}))}),s.on("userconnected",function(e){angular.forEach(a.users,function(a){a.online=e.online.indexOf(a._id)!=-1}),a.$apply()}),s.on("userdisconnected",function(e){angular.forEach(a.users,function(a){e.user==a._id&&(a.online=!1)}),a.$apply()})}]).constant("URI",{API:"http://localhost:3000/api",CHAT:"http://localhost:9000"});
//# sourceMappingURL=app.min.js.map
